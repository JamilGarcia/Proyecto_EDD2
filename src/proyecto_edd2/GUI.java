/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package proyecto_edd2;

import java.awt.event.ActionEvent;
import java.awt.event.MouseEvent;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.EOFException;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.FilenameFilter;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.RandomAccessFile;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Date;
import java.util.HashSet;
import java.util.Random;
import java.util.Scanner;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumn;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.Result;
import javax.xml.transform.Source;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.w3c.dom.DOMImplementation;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Text;

/**
 *
 * @author User
 */
public class GUI extends javax.swing.JFrame {

    ArrayList<Archivo> Lista_Archivos = new ArrayList();
    Archivo archivo_actual;// Objeto para identificar archivo actual

    public GUI() {
        initComponents();
        jl_nombre_archivo.setVisible(false);
        //Cargar Archivos a la lista de archivos
        File directoryPath = new File("./");
        //List text files only
        File[] files = directoryPath.listFiles(new FilenameFilter() {
            @Override
            public boolean accept(File dir, String name) {
                return name.endsWith(".txt");
            }
        });

        for (File file : files) {
            Archivo archivo_temp = new Archivo(file.getAbsolutePath());
            Lista_Archivos.add(archivo_temp);
            Lista_Archivos.get(Lista_Archivos.indexOf(archivo_temp)).setNombre_archivo(file.getName());//Asignar los nombres de archivo
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jd_crearCampo = new javax.swing.JDialog();
        jP_crearCampo = new javax.swing.JPanel();
        jl_CrearCampo = new javax.swing.JLabel();
        jl_NombredeCampo = new javax.swing.JLabel();
        jt_nombreCampo = new javax.swing.JTextField();
        jl_TipodeDato = new javax.swing.JLabel();
        cb_tipoCampo = new javax.swing.JComboBox<>();
        jl_Longitud = new javax.swing.JLabel();
        js_longitud = new javax.swing.JSpinner();
        jb_crearCampo = new javax.swing.JButton();
        jLabel10 = new javax.swing.JLabel();
        jr_llaveSi = new javax.swing.JRadioButton();
        jr_llaveNo = new javax.swing.JRadioButton();
        jb_modCampo = new javax.swing.JButton();
        BgLlavePrimaria = new javax.swing.ButtonGroup();
        jd_abrirArchivo = new javax.swing.JDialog();
        jPanel8 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jT_Archivos = new javax.swing.JTree();
        jLabel1 = new javax.swing.JLabel();
        jb_abrirArchivo = new javax.swing.JButton();
        jb_salirAbrirArchivo = new javax.swing.JButton();
        jd_introducirRegistro = new javax.swing.JDialog();
        jP_introducirRegistro = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        tf_introducirRegistro = new javax.swing.JTextField();
        b_introducirRegistro = new javax.swing.JButton();
        jl_Registro = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jd_modificarRegistro = new javax.swing.JDialog();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        tf_modificarRegistro = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jd_buscarRegistro = new javax.swing.JDialog();
        TablaRegis_NoSeMuestra = new javax.swing.JFrame();
        jScrollPane4 = new javax.swing.JScrollPane();
        jt_Regis_NM = new javax.swing.JTable();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jl_nombre_archivo = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTP_Menus = new javax.swing.JTabbedPane();
        jP_menuArchivo = new javax.swing.JPanel();
        B_Nuevo_Arch = new javax.swing.JButton();
        B_Abrir_Arch = new javax.swing.JButton();
        B_Salvar_Arch = new javax.swing.JButton();
        B_Cerrar_Arch = new javax.swing.JButton();
        B_Salir = new javax.swing.JButton();
        jb_RegistrosPruebas = new javax.swing.JButton();
        jp_Campos = new javax.swing.JPanel();
        B_Crear_Campo = new javax.swing.JButton();
        B_Listar_Campo = new javax.swing.JButton();
        B_Mod_Campo = new javax.swing.JButton();
        B_Borrar_Campo = new javax.swing.JButton();
        jP_tabla_ListarCampos = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        table_ListarCampos = new javax.swing.JTable();
        jl_tituloCampos = new javax.swing.JLabel();
        jPanel5 = new javax.swing.JPanel();
        B_Intro_Regis = new javax.swing.JButton();
        B_Modi_Regis = new javax.swing.JButton();
        B_Buscar_Regis = new javax.swing.JButton();
        B_Borrar_Regis = new javax.swing.JButton();
        B_Listar_Regis = new javax.swing.JButton();
        jp_Registro = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jt_Registro = new javax.swing.JTable();
        jPanel7 = new javax.swing.JPanel();
        B_Expor_Excel = new javax.swing.JButton();
        B_Expo_XML = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        B_Crear_Arch = new javax.swing.JButton();
        B_ReIndex_Arch = new javax.swing.JButton();

        jd_crearCampo.setTitle("Crear Campo");

        jl_CrearCampo.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
        jl_CrearCampo.setText("Crear Campo");

        jl_NombredeCampo.setText("Nombre de campo:");

        jt_nombreCampo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jt_nombreCampoActionPerformed(evt);
            }
        });

        jl_TipodeDato.setText("Tipo de dato:");

        cb_tipoCampo.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "-----", "String", "Int", "Double", "Float", "Char", "Boolean" }));
        cb_tipoCampo.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cb_tipoCampoItemStateChanged(evt);
            }
        });

        jl_Longitud.setText("Longitud:");

        js_longitud.setModel(new javax.swing.SpinnerNumberModel(0, 0, 30, 1));

        jb_crearCampo.setText("Crear Campo");
        jb_crearCampo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jb_crearCampoMouseClicked(evt);
            }
        });

        jLabel10.setText("Es llave primaria:");

        BgLlavePrimaria.add(jr_llaveSi);
        jr_llaveSi.setText("Si ");

        BgLlavePrimaria.add(jr_llaveNo);
        jr_llaveNo.setText("No");

        jb_modCampo.setText("Modificar Campo");
        jb_modCampo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jb_modCampoMouseClicked(evt);
            }
        });

        javax.swing.GroupLayout jP_crearCampoLayout = new javax.swing.GroupLayout(jP_crearCampo);
        jP_crearCampo.setLayout(jP_crearCampoLayout);
        jP_crearCampoLayout.setHorizontalGroup(
            jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_crearCampoLayout.createSequentialGroup()
                .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jP_crearCampoLayout.createSequentialGroup()
                        .addGap(17, 17, 17)
                        .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jl_NombredeCampo)
                            .addComponent(jl_TipodeDato))
                        .addGap(18, 18, 18)
                        .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cb_tipoCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 119, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jt_nombreCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 177, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(87, 87, 87)
                        .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jP_crearCampoLayout.createSequentialGroup()
                                .addComponent(jl_Longitud)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(js_longitud, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jP_crearCampoLayout.createSequentialGroup()
                                .addComponent(jLabel10)
                                .addGap(18, 18, 18)
                                .addComponent(jr_llaveSi)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jr_llaveNo))))
                    .addGroup(jP_crearCampoLayout.createSequentialGroup()
                        .addGap(184, 184, 184)
                        .addComponent(jb_crearCampo)
                        .addGap(54, 54, 54)
                        .addComponent(jb_modCampo)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jP_crearCampoLayout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jl_CrearCampo)
                .addGap(248, 248, 248))
        );
        jP_crearCampoLayout.setVerticalGroup(
            jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_crearCampoLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jl_CrearCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(15, 15, 15)
                .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jt_nombreCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jl_NombredeCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jl_Longitud)
                    .addComponent(js_longitud, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 27, Short.MAX_VALUE)
                .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jP_crearCampoLayout.createSequentialGroup()
                        .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jl_TipodeDato)
                            .addComponent(cb_tipoCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(54, 54, 54)
                        .addGroup(jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jb_crearCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 65, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jb_modCampo, javax.swing.GroupLayout.PREFERRED_SIZE, 65, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jP_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel10)
                        .addComponent(jr_llaveSi)
                        .addComponent(jr_llaveNo)))
                .addGap(27, 27, 27))
        );

        javax.swing.GroupLayout jd_crearCampoLayout = new javax.swing.GroupLayout(jd_crearCampo.getContentPane());
        jd_crearCampo.getContentPane().setLayout(jd_crearCampoLayout);
        jd_crearCampoLayout.setHorizontalGroup(
            jd_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jd_crearCampoLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jP_crearCampo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(23, Short.MAX_VALUE))
        );
        jd_crearCampoLayout.setVerticalGroup(
            jd_crearCampoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jd_crearCampoLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jP_crearCampo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(22, Short.MAX_VALUE))
        );

        javax.swing.tree.DefaultMutableTreeNode treeNode1 = new javax.swing.tree.DefaultMutableTreeNode("Archivos");
        jT_Archivos.setModel(new javax.swing.tree.DefaultTreeModel(treeNode1));
        jT_Archivos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jT_ArchivosMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(jT_Archivos);

        jLabel1.setText("File Manager");

        jb_abrirArchivo.setText("Abrir");
        jb_abrirArchivo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_abrirArchivoActionPerformed(evt);
            }
        });

        jb_salirAbrirArchivo.setText("Salir");
        jb_salirAbrirArchivo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_salirAbrirArchivoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGap(33, 33, 33)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jb_abrirArchivo)
                            .addComponent(jb_salirAbrirArchivo))))
                .addContainerGap(66, Short.MAX_VALUE))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addComponent(jLabel1)
                .addGap(31, 31, 31)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jb_abrirArchivo)
                        .addGap(18, 18, 18)
                        .addComponent(jb_salirAbrirArchivo)))
                .addContainerGap(37, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jd_abrirArchivoLayout = new javax.swing.GroupLayout(jd_abrirArchivo.getContentPane());
        jd_abrirArchivo.getContentPane().setLayout(jd_abrirArchivoLayout);
        jd_abrirArchivoLayout.setHorizontalGroup(
            jd_abrirArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        jd_abrirArchivoLayout.setVerticalGroup(
            jd_abrirArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        jd_introducirRegistro.setMinimumSize(new java.awt.Dimension(260, 210));
        jd_introducirRegistro.setResizable(false);

        jLabel3.setText("Introducir Registro");

        javax.swing.GroupLayout jP_introducirRegistroLayout = new javax.swing.GroupLayout(jP_introducirRegistro);
        jP_introducirRegistro.setLayout(jP_introducirRegistroLayout);
        jP_introducirRegistroLayout.setHorizontalGroup(
            jP_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_introducirRegistroLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addContainerGap(355, Short.MAX_VALUE))
        );
        jP_introducirRegistroLayout.setVerticalGroup(
            jP_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jP_introducirRegistroLayout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jLabel3)
                .addContainerGap())
        );

        b_introducirRegistro.setText("Listo");
        b_introducirRegistro.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                b_introducirRegistroMouseClicked(evt);
            }
        });

        jl_Registro.setText("Registro:");

        jLabel6.setText("Campos");

        javax.swing.GroupLayout jd_introducirRegistroLayout = new javax.swing.GroupLayout(jd_introducirRegistro.getContentPane());
        jd_introducirRegistro.getContentPane().setLayout(jd_introducirRegistroLayout);
        jd_introducirRegistroLayout.setHorizontalGroup(
            jd_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jd_introducirRegistroLayout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(b_introducirRegistro)
                .addGap(86, 86, 86))
            .addGroup(jd_introducirRegistroLayout.createSequentialGroup()
                .addGroup(jd_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jP_introducirRegistro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jd_introducirRegistroLayout.createSequentialGroup()
                        .addGap(15, 15, 15)
                        .addComponent(jl_Registro)
                        .addGap(31, 31, 31)
                        .addComponent(tf_introducirRegistro, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jd_introducirRegistroLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel6)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jd_introducirRegistroLayout.setVerticalGroup(
            jd_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jd_introducirRegistroLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jP_introducirRegistro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel6)
                .addGap(166, 166, 166)
                .addGroup(jd_introducirRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_introducirRegistro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jl_Registro))
                .addGap(18, 18, 18)
                .addComponent(b_introducirRegistro)
                .addGap(81, 81, 81))
        );

        jd_modificarRegistro.setMinimumSize(new java.awt.Dimension(501, 320));
        jd_modificarRegistro.setResizable(false);

        jLabel4.setText("Modificar Registro");

        jLabel5.setText("jLabel5");

        jButton1.setText("Listo");
        jButton1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton1MouseClicked(evt);
            }
        });

        javax.swing.GroupLayout jd_modificarRegistroLayout = new javax.swing.GroupLayout(jd_modificarRegistro.getContentPane());
        jd_modificarRegistro.getContentPane().setLayout(jd_modificarRegistroLayout);
        jd_modificarRegistroLayout.setHorizontalGroup(
            jd_modificarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jd_modificarRegistroLayout.createSequentialGroup()
                .addGroup(jd_modificarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jd_modificarRegistroLayout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addGroup(jd_modificarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel5)
                            .addComponent(jLabel4)
                            .addComponent(tf_modificarRegistro, javax.swing.GroupLayout.PREFERRED_SIZE, 210, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jd_modificarRegistroLayout.createSequentialGroup()
                        .addGap(176, 176, 176)
                        .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(133, Short.MAX_VALUE))
        );
        jd_modificarRegistroLayout.setVerticalGroup(
            jd_modificarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jd_modificarRegistroLayout.createSequentialGroup()
                .addGap(23, 23, 23)
                .addComponent(jLabel4)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel5)
                .addGap(35, 35, 35)
                .addComponent(tf_modificarRegistro, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(62, 62, 62)
                .addComponent(jButton1)
                .addContainerGap(90, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jd_buscarRegistroLayout = new javax.swing.GroupLayout(jd_buscarRegistro.getContentPane());
        jd_buscarRegistro.getContentPane().setLayout(jd_buscarRegistroLayout);
        jd_buscarRegistroLayout.setHorizontalGroup(
            jd_buscarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jd_buscarRegistroLayout.setVerticalGroup(
            jd_buscarRegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        jt_Regis_NM.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane4.setViewportView(jt_Regis_NM);
        if (jt_Regis_NM.getColumnModel().getColumnCount() > 0) {
            jt_Regis_NM.getColumnModel().getColumn(0).setResizable(false);
            jt_Regis_NM.getColumnModel().getColumn(1).setResizable(false);
            jt_Regis_NM.getColumnModel().getColumn(2).setResizable(false);
            jt_Regis_NM.getColumnModel().getColumn(3).setResizable(false);
        }

        javax.swing.GroupLayout TablaRegis_NoSeMuestraLayout = new javax.swing.GroupLayout(TablaRegis_NoSeMuestra.getContentPane());
        TablaRegis_NoSeMuestra.getContentPane().setLayout(TablaRegis_NoSeMuestraLayout);
        TablaRegis_NoSeMuestraLayout.setHorizontalGroup(
            TablaRegis_NoSeMuestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TablaRegis_NoSeMuestraLayout.createSequentialGroup()
                .addGap(82, 82, 82)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(151, Short.MAX_VALUE))
        );
        TablaRegis_NoSeMuestraLayout.setVerticalGroup(
            TablaRegis_NoSeMuestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(TablaRegis_NoSeMuestraLayout.createSequentialGroup()
                .addGap(35, 35, 35)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(24, Short.MAX_VALUE))
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Standard File Manager");

        jl_nombre_archivo.setText("jlabel");

        jLabel2.setFont(new java.awt.Font("Dialog", 0, 24)); // NOI18N
        jLabel2.setText("Standard File Manager");

        jTP_Menus.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                jTP_MenusStateChanged(evt);
            }
        });

        B_Nuevo_Arch.setText("Nuevo Archivo");
        B_Nuevo_Arch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                B_Nuevo_ArchActionPerformed(evt);
            }
        });

        B_Abrir_Arch.setText("Abrir Archivo");
        B_Abrir_Arch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                B_Abrir_ArchActionPerformed(evt);
            }
        });

        B_Salvar_Arch.setText("Salvar Archivo");
        B_Salvar_Arch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                B_Salvar_ArchActionPerformed(evt);
            }
        });

        B_Cerrar_Arch.setText("Cerrar Archivo");
        B_Cerrar_Arch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                B_Cerrar_ArchActionPerformed(evt);
            }
        });

        B_Salir.setText("Salir");
        B_Salir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                B_SalirActionPerformed(evt);
            }
        });

        jb_RegistrosPruebas.setText("Crear Pruebas");
        jb_RegistrosPruebas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jb_RegistrosPruebasMouseClicked(evt);
            }
        });

        javax.swing.GroupLayout jP_menuArchivoLayout = new javax.swing.GroupLayout(jP_menuArchivo);
        jP_menuArchivo.setLayout(jP_menuArchivoLayout);
        jP_menuArchivoLayout.setHorizontalGroup(
            jP_menuArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_menuArchivoLayout.createSequentialGroup()
                .addGap(47, 47, 47)
                .addGroup(jP_menuArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jb_RegistrosPruebas, javax.swing.GroupLayout.PREFERRED_SIZE, 108, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jP_menuArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(B_Salir, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(B_Nuevo_Arch, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(B_Abrir_Arch, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(B_Salvar_Arch, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(B_Cerrar_Arch, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(497, Short.MAX_VALUE))
        );
        jP_menuArchivoLayout.setVerticalGroup(
            jP_menuArchivoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_menuArchivoLayout.createSequentialGroup()
                .addGap(52, 52, 52)
                .addComponent(B_Nuevo_Arch)
                .addGap(44, 44, 44)
                .addComponent(B_Abrir_Arch)
                .addGap(42, 42, 42)
                .addComponent(B_Salvar_Arch)
                .addGap(37, 37, 37)
                .addComponent(B_Cerrar_Arch)
                .addGap(36, 36, 36)
                .addComponent(jb_RegistrosPruebas)
                .addGap(33, 33, 33)
                .addComponent(B_Salir)
                .addContainerGap(172, Short.MAX_VALUE))
        );

        jTP_Menus.addTab("Archivo", jP_menuArchivo);

        B_Crear_Campo.setText("Crear Campo");
        B_Crear_Campo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Crear_CampoMouseClicked(evt);
            }
        });

        B_Listar_Campo.setText("Listar Campos");
        B_Listar_Campo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Listar_CampoMouseClicked(evt);
            }
        });

        B_Mod_Campo.setText("Modificar Campo");
        B_Mod_Campo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Mod_CampoMouseClicked(evt);
            }
        });

        B_Borrar_Campo.setText("Borrar Campo");
        B_Borrar_Campo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Borrar_CampoMouseClicked(evt);
            }
        });

        table_ListarCampos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Nombre", "Tipo de Dato", "Longitud", "Es llave primaria"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Boolean.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(table_ListarCampos);

        jl_tituloCampos.setText("Campo");

        javax.swing.GroupLayout jP_tabla_ListarCamposLayout = new javax.swing.GroupLayout(jP_tabla_ListarCampos);
        jP_tabla_ListarCampos.setLayout(jP_tabla_ListarCamposLayout);
        jP_tabla_ListarCamposLayout.setHorizontalGroup(
            jP_tabla_ListarCamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jP_tabla_ListarCamposLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jP_tabla_ListarCamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jP_tabla_ListarCamposLayout.createSequentialGroup()
                        .addComponent(jl_tituloCampos)
                        .addContainerGap(382, Short.MAX_VALUE))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)))
        );
        jP_tabla_ListarCamposLayout.setVerticalGroup(
            jP_tabla_ListarCamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jP_tabla_ListarCamposLayout.createSequentialGroup()
                .addContainerGap(15, Short.MAX_VALUE)
                .addComponent(jl_tituloCampos)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 249, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(21, 21, 21))
        );

        javax.swing.GroupLayout jp_CamposLayout = new javax.swing.GroupLayout(jp_Campos);
        jp_Campos.setLayout(jp_CamposLayout);
        jp_CamposLayout.setHorizontalGroup(
            jp_CamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_CamposLayout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addGroup(jp_CamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(B_Borrar_Campo)
                    .addComponent(B_Mod_Campo)
                    .addComponent(B_Listar_Campo)
                    .addComponent(B_Crear_Campo))
                .addContainerGap(489, Short.MAX_VALUE))
            .addGroup(jp_CamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jp_CamposLayout.createSequentialGroup()
                    .addContainerGap(208, Short.MAX_VALUE)
                    .addComponent(jP_tabla_ListarCampos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap()))
        );
        jp_CamposLayout.setVerticalGroup(
            jp_CamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_CamposLayout.createSequentialGroup()
                .addGap(45, 45, 45)
                .addComponent(B_Crear_Campo)
                .addGap(47, 47, 47)
                .addComponent(B_Listar_Campo)
                .addGap(47, 47, 47)
                .addComponent(B_Mod_Campo)
                .addGap(44, 44, 44)
                .addComponent(B_Borrar_Campo)
                .addContainerGap(277, Short.MAX_VALUE))
            .addGroup(jp_CamposLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jp_CamposLayout.createSequentialGroup()
                    .addContainerGap(9, Short.MAX_VALUE)
                    .addComponent(jP_tabla_ListarCampos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(207, Short.MAX_VALUE)))
        );

        jTP_Menus.addTab("Campos", jp_Campos);

        B_Intro_Regis.setText("Introducir Registros");
        B_Intro_Regis.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Intro_RegisMouseClicked(evt);
            }
        });

        B_Modi_Regis.setText("Modificar Registros");
        B_Modi_Regis.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Modi_RegisMouseClicked(evt);
            }
        });

        B_Buscar_Regis.setText("Buscar Registros");
        B_Buscar_Regis.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Buscar_RegisMouseClicked(evt);
            }
        });

        B_Borrar_Regis.setText("Borrar Registros");
        B_Borrar_Regis.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Borrar_RegisMouseClicked(evt);
            }
        });

        B_Listar_Regis.setText("Listar Registros");
        B_Listar_Regis.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Listar_RegisMouseClicked(evt);
            }
        });

        jt_Registro.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Campo 1", "Campo 2", "Campo 3", "Campo 4"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane3.setViewportView(jt_Registro);
        if (jt_Registro.getColumnModel().getColumnCount() > 0) {
            jt_Registro.getColumnModel().getColumn(0).setResizable(false);
            jt_Registro.getColumnModel().getColumn(1).setResizable(false);
            jt_Registro.getColumnModel().getColumn(2).setResizable(false);
            jt_Registro.getColumnModel().getColumn(3).setResizable(false);
        }

        javax.swing.GroupLayout jp_RegistroLayout = new javax.swing.GroupLayout(jp_Registro);
        jp_Registro.setLayout(jp_RegistroLayout);
        jp_RegistroLayout.setHorizontalGroup(
            jp_RegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_RegistroLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 374, Short.MAX_VALUE)
                .addGap(20, 20, 20))
        );
        jp_RegistroLayout.setVerticalGroup(
            jp_RegistroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_RegistroLayout.createSequentialGroup()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(38, 38, 38)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(B_Listar_Regis)
                    .addComponent(B_Borrar_Regis)
                    .addComponent(B_Buscar_Regis)
                    .addComponent(B_Modi_Regis)
                    .addComponent(B_Intro_Regis))
                .addGap(18, 18, 18)
                .addComponent(jp_Registro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(49, 49, 49)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jp_Registro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(B_Intro_Regis)
                        .addGap(41, 41, 41)
                        .addComponent(B_Modi_Regis)
                        .addGap(48, 48, 48)
                        .addComponent(B_Buscar_Regis)
                        .addGap(50, 50, 50)
                        .addComponent(B_Borrar_Regis)
                        .addGap(57, 57, 57)
                        .addComponent(B_Listar_Regis)))
                .addContainerGap(145, Short.MAX_VALUE))
        );

        jTP_Menus.addTab("Registros", jPanel5);

        B_Expor_Excel.setText("Expotar Excel");
        B_Expor_Excel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Expor_ExcelMouseClicked(evt);
            }
        });

        B_Expo_XML.setText("Exportar XML con Schema");
        B_Expo_XML.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                B_Expo_XMLMouseClicked(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(48, 48, 48)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(B_Expo_XML)
                    .addComponent(B_Expor_Excel))
                .addContainerGap(437, Short.MAX_VALUE))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(46, 46, 46)
                .addComponent(B_Expor_Excel)
                .addGap(51, 51, 51)
                .addComponent(B_Expo_XML)
                .addContainerGap(407, Short.MAX_VALUE))
        );

        jTP_Menus.addTab("Estandarizacion", jPanel7);

        B_Crear_Arch.setText("Crear Indice");

        B_ReIndex_Arch.setText("Re Indexar Archivos");

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(44, 44, 44)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(B_ReIndex_Arch)
                    .addComponent(B_Crear_Arch))
                .addContainerGap(474, Short.MAX_VALUE))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(40, 40, 40)
                .addComponent(B_Crear_Arch)
                .addGap(60, 60, 60)
                .addComponent(B_ReIndex_Arch)
                .addContainerGap(404, Short.MAX_VALUE))
        );

        jTP_Menus.addTab("Indices", jPanel6);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(263, 263, 263)
                        .addComponent(jLabel2))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(46, 46, 46)
                        .addComponent(jTP_Menus, javax.swing.GroupLayout.PREFERRED_SIZE, 652, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(14, Short.MAX_VALUE))
            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel2Layout.createSequentialGroup()
                    .addGap(102, 102, 102)
                    .addComponent(jl_nombre_archivo, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(500, Short.MAX_VALUE)))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addComponent(jLabel2)
                .addGap(40, 40, 40)
                .addComponent(jTP_Menus, javax.swing.GroupLayout.PREFERRED_SIZE, 581, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel2Layout.createSequentialGroup()
                    .addGap(69, 69, 69)
                    .addComponent(jl_nombre_archivo, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(589, Short.MAX_VALUE)))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 709, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 697, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 686, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 674, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void B_Crear_CampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Crear_CampoMouseClicked

        if (B_Crear_Campo.isEnabled()) {
            jt_nombreCampo.setEnabled(true);
            cb_tipoCampo.setEnabled(true);
            jb_crearCampo.setVisible(true);
            jr_llaveNo.setEnabled(true);
            jr_llaveSi.setEnabled(true);
            jb_modCampo.setVisible(false);
            jl_Longitud.setEnabled(true);
            BgLlavePrimaria.clearSelection();

            jd_crearCampo.setModal(true);
            jd_crearCampo.pack();
            jd_crearCampo.setLocationRelativeTo(this);
            jd_crearCampo.setVisible(true);
        }

    }//GEN-LAST:event_B_Crear_CampoMouseClicked

    private void B_Listar_CampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Listar_CampoMouseClicked

        if (archivo_actual.getLista_campos().isEmpty()) {
            JOptionPane.showMessageDialog(jp_Campos, "No existe ningun campo en este archivo.");
        } else {
            jP_tabla_ListarCampos.setVisible(true);
            refrescarTabla();
        }


    }//GEN-LAST:event_B_Listar_CampoMouseClicked

    private void B_Mod_CampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Mod_CampoMouseClicked

        if (B_Mod_Campo.isEnabled()) {
            if (table_ListarCampos.getSelectedRow() != -1) {

                String tipoDato = (String) table_ListarCampos.getValueAt(table_ListarCampos.getSelectedRow(), 1);
                campo_seleccionado = table_ListarCampos.getSelectedRow();
                Campo campoMod = archivo_actual.getLista_campos().get(campo_seleccionado);

                jb_modCampo.setVisible(true);
                jb_crearCampo.setVisible(false);
                jl_CrearCampo.setText("Editar Campo");
                //Set nombre
                jt_nombreCampo.setText(campoMod.getNombre_Campo());
                //Set el tipo
                if (campoMod.getTipo_dato().equals("string")) {
                    cb_tipoCampo.setSelectedIndex(1);
                } else if (campoMod.getTipo_dato().equals("int")) {
                    cb_tipoCampo.setSelectedIndex(2);
                } else if (campoMod.getTipo_dato().equals("double")) {
                    cb_tipoCampo.setSelectedIndex(3);
                } else if (campoMod.getTipo_dato().equals("float")) {
                    cb_tipoCampo.setSelectedIndex(4);
                } else {
                    //El tipo de dato es un char
                    cb_tipoCampo.setSelectedIndex(5);
                }
                //Set longitud
                js_longitud.setValue((int) campoMod.getLongitud());

                //Set Si es llave primaria o no
                jr_llaveSi.setEnabled(true);
                jr_llaveNo.setEnabled(true);
                if (campoMod.isEsLlavePrimaria()) {
                    jr_llaveSi.setSelected(true);
                    jr_llaveNo.setSelected(false);
                } else {
                    jr_llaveSi.setSelected(false);
                    jr_llaveNo.setSelected(true);
                }

                jd_crearCampo.setModal(true);
                jd_crearCampo.pack();
                jd_crearCampo.setLocationRelativeTo(this);
                jd_crearCampo.setVisible(true);
                table_ListarCampos.clearSelection();
            } else {
                JOptionPane.showMessageDialog(this, "No selecciono un campo en la tabla");
            }
        }
    }//GEN-LAST:event_B_Mod_CampoMouseClicked

    private void B_Borrar_CampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Borrar_CampoMouseClicked

        if (B_Borrar_Campo.isEnabled()) {
            if (table_ListarCampos.getSelectedRow() != -1) {

                DefaultTableModel modelo = (DefaultTableModel) table_ListarCampos.getModel();
                int index = table_ListarCampos.getSelectedRow();

                int opcion_eliminar = JOptionPane.showConfirmDialog(jp_Campos, "Esta seguro que quiere eliminar el campo?",
                        "Eliminar Campo", JOptionPane.YES_NO_OPTION);
                if (opcion_eliminar == 0) {
                    //Selecciono SI el usuario
                    modelo.removeRow(index);
                    archivo_actual.getLista_campos().remove(index);
                    archivo_actual.setGuardado(false);//Archivo se debe salvar
                    JOptionPane.showMessageDialog(jp_Campos, "El campo se ha eliminado de la tabla correctamente");

                    //Preguntar si quiere guardar los cambios
                    if (!archivo_actual.isGuardado()) {
                        //Archivo no esta guardado
                        int resultado = JOptionPane.showConfirmDialog(jP_menuArchivo, "No ha guardado el archivo actual\nDesea guardarlo?"
                                + "", "Cerrar Archivo", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
                        if (resultado == 0) {
                            //Ingresa SI el usuario
                            //Verificar si el archivo es nuevo o si ya ha sido utilizado y guardado antes
                            if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                                B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                            } else {
                                //Solo se guarda el archivo ya existente
                                escribirArchivo();
                                JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha guardado exitosamente!");
                            }
                        } else {
                            //Ingresa NO el usuario 
                            JOptionPane.showMessageDialog(jP_menuArchivo, "No se guardaron los datos del archivo: " + archivo_actual.getNombre_archivo() + " .");
                        }
                    } else {
                        //Archivo esta guardado
                    }
                } else {
                    //Selecciono NO el usuario
                    JOptionPane.showMessageDialog(jp_Campos, "No se elimino el campo.");
                }
            } else {
                JOptionPane.showMessageDialog(this, "No selecciono un campo en la tabla");
            }
        }
    }//GEN-LAST:event_B_Borrar_CampoMouseClicked

    private void jT_ArchivosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jT_ArchivosMouseClicked
        // TODO add your handling code here:

        if ((DefaultMutableTreeNode) jT_Archivos.getLastSelectedPathComponent() == null) {
            nodo_seleccionado = null;
        } else {
            nodo_seleccionado = (DefaultMutableTreeNode) jT_Archivos.getSelectionPath().getLastPathComponent();
        }

    }//GEN-LAST:event_jT_ArchivosMouseClicked

    private void jb_abrirArchivoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_abrirArchivoActionPerformed
        //Abrir el archivo mediante el nodo del Jtree seleccionado

        boolean confirm_open = false;

        if (nodo_seleccionado == null) {
            JOptionPane.showMessageDialog(jd_abrirArchivo, "No se ha seleccionado ningun archivo.");
            confirm_open = false;
        } else if (nodo_seleccionado == jT_Archivos.getModel().getRoot()) {
            JOptionPane.showMessageDialog(jd_abrirArchivo, "No se puede seleccionar la raiz de los archivos");
            confirm_open = false;
        } else if (nodo_seleccionado.getUserObject() == archivo_actual) {
            JOptionPane.showMessageDialog(jd_abrirArchivo, "El archivo seleccionado ya esta abierto.");
        } else {
            //Se selecciono un archivo
            if (archivo_actual == null) {
                //No hay otro archivo abierto
                confirm_open = true;
            } else {
                //Hay un archivo abierto
                int resultado = JOptionPane.showConfirmDialog(jP_menuArchivo, "El archivo '" + archivo_actual.getNombre_archivo()
                        + "' esta abierto\nDesea guardarlo para cerrarlo?", "Abrir Archivo", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
                if (resultado == 0) {
                    //Ingresa SI el usuario
                    //Llevar a opcion de salvar archivo
                    if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                        //Primera ves que se guarda un nuevo archivo
                        B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                    } else {//Ya existia el archivo
                        escribirArchivo();
                        JOptionPane.showMessageDialog(jd_abrirArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha guardado exitosamente!");
                        JOptionPane.showMessageDialog(jd_abrirArchivo, "!El archivo: " + archivo_actual.getNombre_archivo() + " se ha cerrado correctamente!");
                    }

                    confirm_open = true;
                } else {
                    //Ingresa NO el usuario
                    if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                        //si el archivo no se ha guardado antes e ingreso NO, Se pierden los datos
                        Lista_Archivos.remove(archivo_actual);
                        refrescarJTree();
                        archivo_actual = null;
                    }
                    //El archivo abierto no se guardara antes que de abrir uno nuevo
                    if (archivo_actual == null) {
                        JOptionPane.showMessageDialog(jd_abrirArchivo, "No se guardo el ' nuevo archivo ' .");
                    } else {
                        JOptionPane.showMessageDialog(jd_abrirArchivo, "No se guardo el archivo: " + archivo_actual.getNombre_archivo());
                    }

                    confirm_open = true;
                }
            }
        }

        if (confirm_open) {
            archivo_actual = null;
            archivo_actual = (Archivo) nodo_seleccionado.getUserObject();
            JOptionPane.showMessageDialog(jd_abrirArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha abierto exitosamente!");
            jl_nombre_archivo.setText(archivo_actual.getNombre_archivo());
            archivo_actual.setGuardado(false);
            jl_nombre_archivo.setVisible(true);
            jd_abrirArchivo.dispose();

            //Verificar numero de registros para habilitar opciones de campos
            int verificar_registro = actualizar_numRegistros(1);
            if (verificar_registro == 0) {
                B_Crear_Campo.setEnabled(true);
                B_Mod_Campo.setEnabled(true);
                B_Borrar_Campo.setEnabled(true);
            } else {
                //Ya existe minimo 1 registro, desabilitar funciones de campos
                B_Crear_Campo.setEnabled(false);
                B_Mod_Campo.setEnabled(false);
                B_Borrar_Campo.setEnabled(false);
            }
            //Leer campos y agregarlos a la lista de campos del archivo
            Scanner sc;
            ArrayList<String> buffer = new ArrayList();
            int sizeCampos;
            try {
                sc = new Scanner(archivo_actual.getArchivo());
                sizeCampos = sc.nextInt();

                for (int i = 0; i < sizeCampos; i++) {

                    String cadena = sc.next();
                    cadena = cadena.substring(1, cadena.length() - 1);
                    buffer.add(cadena);
                }
            } catch (Exception e) {
            }

            Scanner parse;
            ArrayList<String> tokens = new ArrayList();

            for (int i = 0; i < buffer.size(); i++) {
                String var = buffer.get(i);
                parse = new Scanner(var);
                parse.useDelimiter(",");
                while (parse.hasNext()) {
                    tokens.add(parse.next());
                }
                parse.reset();
            }
            buffer.clear();

            for (int i = 0; i < tokens.size(); i++) {
                parse = new Scanner(tokens.get(i));
                parse.useDelimiter(":");
                while (parse.hasNext()) {
                    parse.next();
                    buffer.add(parse.next());
                }
            }

            int index = buffer.size() / 4;
            String nombre = "", tipo = "";
            int longitud = 0;
            String esLlave = "";
            int flag = 0, secondaryFlag = 0;

            archivo_actual.getLista_campos().clear();

            while (flag < index) {
                nombre = buffer.get(secondaryFlag);
                secondaryFlag++;

                tipo = buffer.get(secondaryFlag);
                secondaryFlag++;

                longitud = Integer.parseInt(buffer.get(secondaryFlag));
                secondaryFlag++;

                esLlave = buffer.get(secondaryFlag);
                secondaryFlag++;

                Campo campo = new Campo(nombre, tipo, longitud);

                if (esLlave.equals("true")) {
                    campo.setEsLlavePrimaria(true);
                }
                archivo_actual.getLista_campos().add(campo);
                flag++;
            }
        }
    }//GEN-LAST:event_jb_abrirArchivoActionPerformed

    private void jb_salirAbrirArchivoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_salirAbrirArchivoActionPerformed
        //Cerrar JDialog para abrir archivo
        jd_abrirArchivo.dispose();
    }//GEN-LAST:event_jb_salirAbrirArchivoActionPerformed

    private void B_Nuevo_ArchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_B_Nuevo_ArchActionPerformed
        //Creacion de un nuevo archivo vacio
        //Verificacion si hay un archivo abierto
        if (archivo_actual == null) {
            //do nothing
        } else {
            //Hay un archivo abierto, preguntar si lo quiere guardar para cerrarlo
            int resultado_guardar = JOptionPane.showConfirmDialog(jP_menuArchivo, "No ha guardado el archivo actual\nDesea guardarlo?"
                    + "", "Salir", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            //Llevar a metodo salvar archivo 
            if (resultado_guardar == 0) {
                //Selecciono SI
                if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                    //Es la primera vez que se guarda el archivo
                    B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                } else {
                    //El archivo ya se ha guardado previamente
                    escribirArchivo();
                }
            } else {
                //Selecciono NO
                if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                    Lista_Archivos.remove(archivo_actual);
                }
                JOptionPane.showMessageDialog(jP_menuArchivo, "No se guardo el archivo: '" + archivo_actual.getNombre_archivo() + "'.");
                archivo_actual = null;

            }
        }

        JOptionPane.showMessageDialog(jP_menuArchivo, "cargando...");
        Archivo archivo_nuevo = new Archivo("./nuevo_archivo.txt");
        Lista_Archivos.add(archivo_nuevo);
        archivo_actual = archivo_nuevo;
        JOptionPane.showMessageDialog(jP_menuArchivo, "Se ha creado el  archivo exitosamente",
                "nuevo archivo", JOptionPane.INFORMATION_MESSAGE);
        //Agregar el nombre del documento en la pantalla principal
        jl_nombre_archivo.setText(archivo_actual.getNombre_archivo());
        jl_nombre_archivo.setVisible(true);
        //Refrescar JTree Archivos
        refrescarJTree();
    }//GEN-LAST:event_B_Nuevo_ArchActionPerformed

    private void B_Abrir_ArchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_B_Abrir_ArchActionPerformed
        //Abrir ventana para abrir archivo
        if (Lista_Archivos.isEmpty()) {
            JOptionPane.showMessageDialog(jP_menuArchivo, "No hay ningun archivo en el sistema.",
                    "Advertencia Abrir Archivo", JOptionPane.WARNING_MESSAGE);
        } else {
            nodo_seleccionado = null;
            refrescarJTree();
            jd_abrirArchivo.setModal(true);
            jd_abrirArchivo.pack();
            jd_abrirArchivo.setLocationRelativeTo(this);
            jd_abrirArchivo.setVisible(true);
        }

    }//GEN-LAST:event_B_Abrir_ArchActionPerformed

    private void B_Salvar_ArchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_B_Salvar_ArchActionPerformed
        //Metodo salvar archivo
        String nombre_archivo = null;
        boolean confirm_name = false;
        boolean confirm_save = false;

        if (archivo_actual != null) {
            //Revisar si el archivo ya esta guardado
            if (archivo_actual.isGuardado()) {
                JOptionPane.showMessageDialog(jP_menuArchivo, "El archivo: '" + archivo_actual.getNombre_archivo()
                        + "' ya esta guardado.");
            } else {
                //El archivo no esta guardado
                //Revisar si el archivo ya tiene un nombre guardado
                if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                    //No tiene un nombre guardado, significando salvar por 1era vez el archivo
                    while (!confirm_name) {
                        nombre_archivo = JOptionPane.showInputDialog(jP_menuArchivo, "Ingrese el nombre del archivo: ",
                                "Salvar Archivo", JOptionPane.DEFAULT_OPTION);

                        if (nombre_archivo != null) {
                            //El usuario ingreso el nombre del archivo
                            //No se puede utilizar el nombre "nuevo documento" ya que es el nombre base
                            if (nombre_archivo.equals("nuevo archivo")) {
                                JOptionPane.showMessageDialog(jP_menuArchivo, "No se puede utilizar el nombre 'nuevo archivo\n'"
                                        + "por decision del desarrolador.");
                            } else {
                                confirm_name = true;
                            }

                            if (confirm_name) {
                                //Si pasa la primera validacion puede ir a la segunda validacion
                                //Revisar validaciones para el nombre
                                if (nombre_archivo.contains(".")) {
                                    //El archivo no puede llevar un punto
                                    JOptionPane.showMessageDialog(jP_menuArchivo, "El Archivo no puede incluir un '.'",
                                            "Advertencia", JOptionPane.WARNING_MESSAGE);
                                    confirm_name = false;
                                } else {
                                    confirm_name = true;
                                }
                                if (confirm_name) {
                                    //Revisar que el nombre no sea igual a otro archivo
                                    nombre_archivo = nombre_archivo + ".txt";
                                    for (int i = 0; i < Lista_Archivos.size(); i++) {
                                        if (nombre_archivo.equals(Lista_Archivos.get(i).getNombre_archivo())) {
                                            //El nombre se repite
                                            JOptionPane.showMessageDialog(jP_menuArchivo, "El nombre " + nombre_archivo + " ya esta siendo "
                                                    + "utilizado para otro archivo", "Advertencia", JOptionPane.WARNING_MESSAGE);
                                            confirm_name = false;
                                            break;
                                        } else {
                                            confirm_name = true;
                                        }
                                    }
                                }
                            }
                            //Confirmacion de dato
                            if (confirm_name) {
                                archivo_actual.setNombre_archivo(nombre_archivo);
                                archivo_actual.setArchivo("./" + nombre_archivo);
                                confirm_save = true;
                            }
                        } else {
                            //do nothing, eligio la opcion cancelar
                            confirm_name = true;
                            confirm_save = false;
                        }
                    }
                } else {
                    //El archivo ya tiene nombre propio y se ha guardado minimo 1 vez
                    int opcion_save = JOptionPane.showConfirmDialog(jP_menuArchivo, "Desea guardar el archivo "
                            + archivo_actual.getNombre_archivo() + "?", "Salvar Archivo", JOptionPane.YES_NO_OPTION);
                    if (opcion_save == 0) {
                        //Selecciono SI el usuario
                        confirm_save = true;
                    } else {
                        //Selecciono NO el usuario
                        confirm_save = false;
                    }
                }
                //Guardar si se ha confirmado por medio de las validaciones
                if (confirm_save == true) {
                    //Escribir el archivo
                    escribirArchivo();
                    JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo se ha guardado exitosamente!");
                    archivo_actual.setGuardado(true);
                    jl_nombre_archivo.setText(archivo_actual.getNombre_archivo());
                    //Refrescar JTree
                    refrescarJTree();
                } else {/*No se guarda el programa, do nothing*/
                }
            }

        } else {
            //No hay un archivo siendo utilizado
            JOptionPane.showMessageDialog(jP_menuArchivo, "No se esta utilizando ningun archivo.\n", "Advertencia",
                    JOptionPane.INFORMATION_MESSAGE);
        }
    }//GEN-LAST:event_B_Salvar_ArchActionPerformed

    private void B_Cerrar_ArchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_B_Cerrar_ArchActionPerformed
        //Metodo cerrar archivo
        boolean confirm_cerrar = false;
        if (archivo_actual != null) {
            //Hay un archivo abierto
            if (!archivo_actual.isGuardado()) {
                //Archivo no esta guardado
                int resultado = JOptionPane.showConfirmDialog(jP_menuArchivo, "No ha guardado el archivo actual\nDesea guardarlo?"
                        + "", "Cerrar Archivo", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
                if (resultado == 0) {
                    //Ingresa SI el usuario
                    //Verificar si el archivo es nuevo o si ya ha sido utilizado y guardado antes
                    if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                        B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                    } else {
                        //Solo se guarda el archivo ya existente
                        escribirArchivo();
                        JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha guardado exitosamente!");
                    }

                    confirm_cerrar = true;
                } else {
                    //Ingresa NO el usuario 
                    JOptionPane.showMessageDialog(jP_menuArchivo, "No se guardaron los datos del archivo: " + archivo_actual.getNombre_archivo() + " .",
                            "Cerrar Archivo", JOptionPane.DEFAULT_OPTION);
                    confirm_cerrar = true;
                }
            } else {
                //Archivo esta guardado
                confirm_cerrar = true;
            }
        } else {
            //No hay un archivo abierto por el momento
            JOptionPane.showMessageDialog(jP_menuArchivo, "No hay ningun archivo abierto actualmente."
                    + "\nNo puede hacer uso de esta funcin.", "Error", JOptionPane.INFORMATION_MESSAGE);
        }
        //Cerrar Archivo
        if (confirm_cerrar) {
            archivo_actual = null;
            jl_nombre_archivo.setVisible(false);
            JOptionPane.showMessageDialog(jP_menuArchivo, "Se ha cerrado el archivo correctamente."
                    + "", "Cerrar Archivo", JOptionPane.DEFAULT_OPTION);
            //Ocultar tabla
            jP_tabla_ListarCampos.setVisible(false);
        }
    }//GEN-LAST:event_B_Cerrar_ArchActionPerformed

    private void B_SalirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_B_SalirActionPerformed
        //Metodo salir
        boolean confirmar_salir = false;
        if (archivo_actual != null && !archivo_actual.isGuardado()) {
            //Se esta usando un archivo y no esta guardado
            int resultado = JOptionPane.showConfirmDialog(jP_menuArchivo, "No ha guardado el archivo actual: " + archivo_actual.getNombre_archivo() + "\nDesea guardarlo?"
                    + "", "Salir", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            if (resultado == 0) {
                //Ingresa SI el usuario
                //Verificar si el archivo es nuevo o si ya ha sido guardado, llevar a opcion de salvar archivo
                if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                    B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                } else {
                    //El archivo no es nuevo
                    JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha guardado exitosamente!");
                    JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo: " + archivo_actual.getNombre_archivo() + " se ha cerrado correctamente!");
                    escribirArchivo();
                    archivo_actual = null;
                }
                confirmar_salir = true;
            } else {
                //Ingresa NO el usuario
                confirmar_salir = true;
            }
        } else {
            confirmar_salir = true;
        }

        if (confirmar_salir) {
            int resultado_salir = JOptionPane.showConfirmDialog(jP_menuArchivo, "Esta seguro de salir?"
                    + "", "Salir", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
            if (resultado_salir == 0) { // Ingreso SI el usuario
                JOptionPane.showMessageDialog(jP_menuArchivo, "Hasta Luego.", "Salir", JOptionPane.PLAIN_MESSAGE);
                System.exit(0);
            } else {//Ingreso NO el usuario
                //do nothing
            }
        }
    }//GEN-LAST:event_B_SalirActionPerformed

    private void jTP_MenusStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_jTP_MenusStateChanged
        //Cambio de Tab
        int indice_menu = jTP_Menus.getSelectedIndex();
        if (archivo_actual == null && indice_menu > 0) {
            jTP_Menus.setSelectedIndex(0);
            JOptionPane.showMessageDialog(jP_menuArchivo, "No hay archivos en el sistema.\n"
                    + "Debe abrir o crear un nuevo archivo para acceder al resto de funciones.");
        }

        if (archivo_actual != null) {
            jP_tabla_ListarCampos.setVisible(false);
            jp_Registro.setVisible(false);
        }
    }//GEN-LAST:event_jTP_MenusStateChanged

    private void jb_crearCampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jb_crearCampoMouseClicked

        boolean confirmar_crearCampo = false;
        boolean continuar_addCampo = true;
        Campo nuevoCampo = new Campo();

        //El usuario puede agregar los campo que desee
        confirmar_crearCampo = false;
        //Validar entradas de datos
        //Validar nombre de campo
        if (jt_nombreCampo.getText().isEmpty()) {
            JOptionPane.showMessageDialog(jd_crearCampo, "!No puede dejar en blanco el nombre del campo!");
            confirmar_crearCampo = false;
        } else {
            confirmar_crearCampo = true;
            nuevoCampo.setNombre_Campo(jt_nombreCampo.getText());
        }

        //Validar Tipo de Dato
        if (cb_tipoCampo.getSelectedIndex() == 0) {
            JOptionPane.showMessageDialog(jd_crearCampo, "Debe elegir el tipo del dato.");
            confirmar_crearCampo = false;
        } else {
            int opcion = cb_tipoCampo.getSelectedIndex();
            //Agregar el tipo de dato que selecciono el usuario
            switch (opcion) {
                case 1:
                    //Eligio String
                    nuevoCampo.setTipo_dato("String");
                    break;
                case 2:
                    //Eligio Int
                    nuevoCampo.setTipo_dato("int");
                    break;
                case 3:
                    //Eligio Double
                    nuevoCampo.setTipo_dato("double");
                    break;
                case 4:
                    //Eligio Float
                    nuevoCampo.setTipo_dato("float");
                    break;
                case 5:
                    //Eligio Char
                    nuevoCampo.setTipo_dato("char");
                    nuevoCampo.setLongitud(1);
                    break;
                case 6:
                    //Eligio boolean
                    nuevoCampo.setTipo_dato("boolean");
                    break;
                default:
                    break;
            }
            confirmar_crearCampo = true;

        }
        //Longitud de un char solo puede ser 1
        if (nuevoCampo.getTipo_dato().equals("char") && (int) js_longitud.getValue() != 1) {
            JOptionPane.showMessageDialog(jd_crearCampo, "El tipo de dato 'char' solo puede tener una longitud de 1.");
            confirmar_crearCampo = false;
        }

        //Validar Longitud
        if ((int) js_longitud.getValue() == 0 || (int) js_longitud.getValue() > 30) {
            JOptionPane.showMessageDialog(jd_crearCampo, "La longitud del campo debe ser mayor a 0.");
            confirmar_crearCampo = false;
        } else {
            confirmar_crearCampo = true;
            nuevoCampo.setLongitud((int) js_longitud.getValue());
        }

        //Validar Si es llave primaria
        //Recuperamos la eleccion de marcar como llave primaria
        boolean esllavePrimaria = false;

        if (!jr_llaveNo.isSelected() && !jr_llaveSi.isSelected()) {
            //No selecciono sobre la opcion si el campo es llave primaria
            JOptionPane.showMessageDialog(jd_crearCampo, "Debe elegir si el campo es una llave primaria o no.");
            confirmar_crearCampo = false;
        } else {
            if (jr_llaveSi.isSelected() || jr_llaveNo.isSelected()) {
                if (jr_llaveSi.isSelected()) {
                    esllavePrimaria = true;
                } else {
                    esllavePrimaria = false;
                }
            }
            confirmar_crearCampo = true;
        }

        //Busqueda para verificar que no haya otra llave primaria
        if (archivo_actual.getLista_campos().isEmpty()) {
            //La lista de campos esta vacia 
            if (esllavePrimaria) {
                //eligio el campo como llave primaria
                nuevoCampo.setEsLlavePrimaria(true);
            } else {
                //do nothing, no eligio el campo como llave primaria
            }
        } else {
            //La lista de campos no esta vacia
            //Recorrer la lista y verificar que otro campo no sea una llave primaria
            boolean confirm_LlaveP = true;
            if (esllavePrimaria) {
                for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
                    if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria() == true) {
                        confirm_LlaveP = false;
                        break;
                    }
                }
                //Mostrar mensaje que ya existe otra una llave primaria
                if (!confirm_LlaveP) {
                    JOptionPane.showMessageDialog(jd_crearCampo, "Otro campo ya es una llave primaria en este archivo.");
                    confirmar_crearCampo = false;
                    jr_llaveSi.setSelected(false);
                } else {
                    nuevoCampo.setEsLlavePrimaria(true);
                    confirmar_crearCampo = true;
                }
            }

        }

        //Ultima verificacion
        if (nuevoCampo.getNombre_Campo() == null || nuevoCampo.getTipo_dato() == null
                || nuevoCampo.getLongitud() == 0) {
            confirmar_crearCampo = false;
        }

        //Crear campo
        if (confirmar_crearCampo == true) {
            archivo_actual.getLista_campos().add(nuevoCampo);
            JOptionPane.showMessageDialog(jd_crearCampo, "Se creo el campo exitosamente!");
            //Si el panel donde esta la tabla esta habilitado actualizarla
            if (jP_tabla_ListarCampos.isVisible()) {
                refrescarTabla();
            }
            archivo_actual.setGuardado(false);
            jt_nombreCampo.setText("");
            cb_tipoCampo.setSelectedIndex(0);
            js_longitud.setValue(0);
            jr_llaveNo.setSelected(false);
            jr_llaveSi.setSelected(false);
            jd_crearCampo.dispose();
        }
    }//GEN-LAST:event_jb_crearCampoMouseClicked

    private void jb_modCampoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jb_modCampoMouseClicked

        boolean confirmar_modCampo = false;
        Campo Campo_mod = archivo_actual.getLista_campos().get(campo_seleccionado);
        String tipo_mod = "";
        //El usuario puede agregar los campo que desee
        //Validar entradas de datos
        //Validar nombre de campo
        if (jt_nombreCampo.getText().isEmpty()) {
            JOptionPane.showMessageDialog(jd_crearCampo, "!No puede dejar en blanco el nombre del campo!");
            confirmar_modCampo = false;
        } else {
            confirmar_modCampo = true;

        }
        //Validar Tipo de Dato
        if (cb_tipoCampo.getSelectedIndex() == 0) {
            JOptionPane.showMessageDialog(jd_crearCampo, "Debe elegir el tipo del dato.");
            confirmar_modCampo = false;
        } else {
            int opcion = cb_tipoCampo.getSelectedIndex();
            //Agregar el tipo de dato que selecciono el usuario
            switch (opcion) {
                case 1:
                    //Eligio String
                    tipo_mod = "String";
                    break;
                case 2:
                    //Eligio Int
                    tipo_mod = "int";
                    break;
                case 3:
                    //Eligio Double
                    tipo_mod = "double";
                    break;
                case 4:
                    //Eligio Float
                    tipo_mod = "float";
                    break;
                case 5:
                    //Eligio Char
                    tipo_mod = "char";
                    break;
                default:
            }
            confirmar_modCampo = true;
        }

        //Validar Longitud
        if ((int) js_longitud.getValue() == 0) {
            JOptionPane.showMessageDialog(jd_crearCampo, "La longitud del campo debe ser mayor a 0.");
            confirmar_modCampo = false;
        } else if ((int) js_longitud.getValue() > 30) {
            JOptionPane.showMessageDialog(jd_crearCampo, "La longitud del campo no puede ser ser mayor a 30.");
            confirmar_modCampo = false;
        } else {
            confirmar_modCampo = true;
        }

        //Validar Si es llave primaria
        //Recuperamos la eleccion de marcar como llave primaria
        boolean esllavePrimaria = false;

        if (!jr_llaveNo.isSelected() && !jr_llaveSi.isSelected()) {
            //No selecciono sobre la opcion si el campo es llave primaria
            JOptionPane.showMessageDialog(jd_crearCampo, "Debe elegir si el campo es una llave primaria o no.");
        }

        boolean confirm_LlaveP = true;
        if (jr_llaveSi.isSelected()) {
            esllavePrimaria = true;
        } else {
            esllavePrimaria = false;
            confirm_LlaveP = false;
        }

        //Busqueda para verificar que no haya otra llave primaria
        if (archivo_actual.getLista_campos().isEmpty()) {
            //La lista de campos esta vacia 
            if (esllavePrimaria) {
                //eligio el campo como llave primaria
                Campo_mod.setEsLlavePrimaria(true);
            } else {
                //do nothing, no eligio el campo como llave primaria
            }
        } else {
            //La lista de campos no esta vacia
            //Recorrer la lista y verificar que otro campo no sea una llave primaria

            if (esllavePrimaria) {
                for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
                    if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria() == true) {
                        if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria() == Campo_mod.isEsLlavePrimaria()) {
                            confirm_LlaveP = true;
                            break;
                        } else {
                            confirm_LlaveP = false;
                            break;
                        }

                    }
                }
                //Mostrar mensaje que ya existe otra una llave primaria
                if (!confirm_LlaveP) {
                    JOptionPane.showMessageDialog(jd_crearCampo, "Otro campo ya es una llave primaria en este archivo.");
                    confirmar_modCampo = false;
                } else {
                    confirmar_modCampo = true;
                }
            }

        }

        //Ultima verificacion
        if (Campo_mod.getNombre_Campo() == null || Campo_mod.getTipo_dato() == null
                || Campo_mod.getLongitud() == 0) {
            confirmar_modCampo = false;
        }
        //Crear campo

        if (Campo_mod.getNombre_Campo().equals(jt_nombreCampo.getText()) && Campo_mod.getTipo_dato().equals(tipo_mod)
                && Campo_mod.getLongitud() == (int) js_longitud.getValue()) {
            if (!confirm_LlaveP == false && !Campo_mod.isEsLlavePrimaria()) {

            } else if (confirm_LlaveP == false && Campo_mod.isEsLlavePrimaria()) {
                JOptionPane.showMessageDialog(jd_crearCampo, "No se realizo ninguna modificacion en el campo.");
                confirmar_modCampo = false;
                archivo_actual.setGuardado(false);
                jt_nombreCampo.setText("");
                cb_tipoCampo.setSelectedIndex(0);
                js_longitud.setValue(0);
                jr_llaveNo.setSelected(false);
                jr_llaveSi.setSelected(false);
                jd_crearCampo.dispose();
            }

        }
        if (confirmar_modCampo == true) {

            //Realizar modificaciones
            Campo_mod.setNombre_Campo(jt_nombreCampo.getText());//Modificar Nombre
            Campo_mod.setTipo_dato(tipo_mod);//Modificar Tipo de Dato
            Campo_mod.setLongitud((int) js_longitud.getValue());

            if (!confirm_LlaveP) {
                Campo_mod.setEsLlavePrimaria(false);
            } else {
                Campo_mod.setEsLlavePrimaria(true);
            }

            JOptionPane.showMessageDialog(jd_crearCampo, "Se modifico el campo exitosamente!");
            //Si el panel donde esta la tabla esta habilitado actualizarla
            if (jP_tabla_ListarCampos.isVisible()) {
                refrescarTabla();
            }
            archivo_actual.setGuardado(false);
            jt_nombreCampo.setText("");
            cb_tipoCampo.setSelectedIndex(0);
            js_longitud.setValue(0);
            jr_llaveNo.setSelected(false);
            jr_llaveSi.setSelected(false);
            jd_crearCampo.dispose();

            //Preguntar si quiere guardar el archivo
            if (!archivo_actual.isGuardado()) {
                //Archivo no esta guardado
                int resultado = JOptionPane.showConfirmDialog(jP_menuArchivo, "No ha guardado el archivo actual\nDesea guardarlo?"
                        + "", "Cerrar Archivo", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);
                if (resultado == 0) {
                    //Ingresa SI el usuario
                    //Verificar si el archivo es nuevo o si ya ha sido utilizado y guardado antes
                    if (archivo_actual.getNombre_archivo().equals("nuevo archivo")) {
                        B_Salvar_ArchActionPerformed(new ActionEvent(this, ActionEvent.ACTION_PERFORMED, null));
                    } else {
                        //Solo se guarda el archivo ya existente
                        escribirArchivo();
                        JOptionPane.showMessageDialog(jP_menuArchivo, "!El archivo " + archivo_actual.getNombre_archivo() + " se ha guardado exitosamente!");
                    }

                } else {
                    //Ingresa NO el usuario 
                    JOptionPane.showMessageDialog(jP_menuArchivo, "No se guardaron los datos del archivo: " + archivo_actual.getNombre_archivo() + " .");
                }
            } else {
                //Archivo esta guardado
            }
        }


    }//GEN-LAST:event_jb_modCampoMouseClicked

    private void jt_nombreCampoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jt_nombreCampoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jt_nombreCampoActionPerformed

    private void B_Intro_RegisMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Intro_RegisMouseClicked
        //Abir ventana introducir registro
        boolean verificar_introducirR = false;
        //Verificar si existen campos
        if (archivo_actual.getLista_campos().isEmpty()) {
            //No existe ningun campo
            JOptionPane.showMessageDialog(jP_menuArchivo, "No existe ningun campo.\nDebe crear algun campo para introducir un registro");
            verificar_introducirR = false;
        } else {
            verificar_introducirR = true;
        }
        //Verificar que existe una llave primaria dentro de los campos
        boolean existe_llavePrimaria = false;
        for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
            if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria() == true) {
                existe_llavePrimaria = true;
                break;
            }
        }

        if (!existe_llavePrimaria) {
            JOptionPane.showMessageDialog(jP_menuArchivo, "Debe asignar a un campo como llave primaria.");
            verificar_introducirR = false;
        } else {
            verificar_introducirR = true;
        }

        //Nombres del archivo bin para cargar el arbol
        int instancia_punto = archivo_actual.getNombre_archivo().indexOf('.');
        String nombre_archivo_bin = "./" + archivo_actual.getNombre_archivo().substring(0, instancia_punto) + ".bin";
        System.out.println(nombre_archivo_bin);
        if (verificar_introducirR) {
            int contador_listaCampos = 0, verify_primay_key = 0, valor_primaryKey = 0;
            String registro = "", key = "", porcion_registro = null;
            boolean verificar_input;

            //Crear registro
            while (contador_listaCampos < archivo_actual.getLista_campos().size()) {
                verificar_input = true;
                Campo campo_temp = archivo_actual.getLista_campos().get(contador_listaCampos);//Variable temporal de Campo
                String tipo_dato_evaluar = campo_temp.getTipo_dato();

                //Entrada de dato por campo
                porcion_registro = JOptionPane.showInputDialog(jP_menuArchivo, "Entrada para el campo: "
                        + campo_temp.getNombre_Campo() + "\nTipo de Dato: " + campo_temp.getTipo_dato()
                        + "\nLongitud: " + campo_temp.getLongitud() + "\nEs Llave Primaria: " + campo_temp.isEsLlavePrimaria());
                
            
                
                //Validaciones
                //1. Verificacion que la entrada no este vacia
                if (porcion_registro == null) {
                    verificar_input = false;
                    break;
                } else {
                    //2.Verificacion no puede poner el delimitador  '|' en el dato
                    if (porcion_registro.contains("|")) {
                        JOptionPane.showMessageDialog(jP_menuArchivo, "No es permitido utilizar el caracter '|' en este programa.");
                        verificar_input = false;
                    }
                    //3.Verificacion que ingrese el tipo de dato correcto    
                    if (tipo_dato_evaluar.equals("int")) {

                        try {
                            Integer.parseInt(porcion_registro);
                            valor_primaryKey = Integer.parseInt(porcion_registro);
                        } catch (NumberFormatException e) {
                            JOptionPane.showMessageDialog(jP_menuArchivo, "El tipo de dato ingresado es incorrecto, debe ser un int.");
                            verificar_input = false;
                        }

                    } else if (tipo_dato_evaluar.equals("char")) {
                        if (porcion_registro.length() > 1) {
                            JOptionPane.showMessageDialog(jP_menuArchivo, "Un dato char solo recibe un valor de entrada.");
                            verificar_input = false;
                        }

                    } else if (tipo_dato_evaluar.equals("double")) {
                        try {
                            Double.parseDouble(porcion_registro);
                        } catch (NumberFormatException e) {
                            JOptionPane.showMessageDialog(jP_menuArchivo, "El tipo de dato ingresado es incorrecto, debe ser un double");
                            verificar_input = false;
                        }

                    } else if (tipo_dato_evaluar.equals("String")) {
                        if (campo_temp.isEsLlavePrimaria()) {
                            try {
                                Integer.parseInt(porcion_registro);
                                valor_primaryKey = Integer.parseInt(porcion_registro);
                            } catch (NumberFormatException e) {
                                JOptionPane.showMessageDialog(jP_menuArchivo, "El tipo de dato ingresado es incorrecto, la llave primaria debe ser un numero");
                                verificar_input = false;
                            }
                        } else {
                            //El dato ingresado no puede estar en null / blanco
                            if (porcion_registro.equals("")) {
                                JOptionPane.showMessageDialog(jP_menuArchivo, "Debe ingresar alguno dato.");
                                verificar_input = false;
                                System.out.println("Hola");
                            }
                        }
                    }

                    //4.Verificacion que llene  longitud si es llave primaria
                    if (campo_temp.isEsLlavePrimaria() && porcion_registro.length() < campo_temp.getLongitud()) {
                        JOptionPane.showMessageDialog(jP_menuArchivo, "El dato para el campo primario debe ser de la longitud requerida");
                        verificar_input = false;
                    }

                    //5. Todos los datos deben seguir la longitud del campo requerida
                    if (porcion_registro.length() > campo_temp.getLongitud()) {
                        JOptionPane.showMessageDialog(jP_menuArchivo, "El dato ingresado es mayor a la longitud requerida del campo.\n"
                                + "Debe volver a ingresar el dato.");
                        verificar_input = false;
                    }

                    //6. Si no es llave primaria y no lleno a la longitud requerida, llenar con espacios en blanco 
                    if (!campo_temp.isEsLlavePrimaria() && porcion_registro.length() < campo_temp.getLongitud()) {
//                        for (int i = porcion_registro.length(); i < campo_temp.getLongitud(); i++) {
//                            porcion_registro += " ";
//                        }
//                        System.out.println(porcion_registro.length());
                        
                          porcion_registro = fixLength(porcion_registro, campo_temp.getLongitud());
                    }

                    //7.Verificar que no se repite la llave primaria 
                    if (campo_temp.isEsLlavePrimaria()) {

                        ArbolB btree_verificar = cargarArbol(nombre_archivo_bin);
                        
                        if (btree_verificar == null) {
                            //No existe el arbol, seria la primera insercion, no busca
                            
                        } else {
                            //Exsite el arbol y algun registro
                            Llave verify_key = btree_verificar.buscarLlave(btree_verificar.getRaiz(), valor_primaryKey);
                            if (verify_key == null) {
                                //No la encontro puede continuar
                            } else {
                                //Encontro la llave primaria
                                verificar_input = false;
                                JOptionPane.showMessageDialog(jP_menuArchivo, "El dato ingresado para la llave primaria no es valido.\n"
                                        + "Se encontro que ya existe el valor dentro de los registros.");
                            }
                        }
                    }

                }
                //Verificar que campo donde llave primaria es unica
                if (verificar_input) {
                    //Paso todas las validaciones
                    registro += porcion_registro;
                    registro += "|";
                    contador_listaCampos++;
                    //Obtener el valor de llave primaria 
                    if (campo_temp.isEsLlavePrimaria() && verify_primay_key == 0) {
                        //Si es el primer campo empieza en 0 pq el valor obtenido es -1 
                        key = porcion_registro;
                        verify_primay_key = 1;
                    }
                }
            }
            //Si logro recorrer los campos correctamente el archivo se puede recorrer 
            registro += "\n";
            if (contador_listaCampos == archivo_actual.getLista_campos().size()) {
                //Escribir registro en el archivo
                try {
                    //Incrementamos el contador de escribir archivos
                    RandomAccessFile raf = new RandomAccessFile(archivo_actual.getArchivo(), "rw");
                    raf.seek(raf.length());
                    long offset = raf.getFilePointer();
                    raf.writeChars(registro);
                    //Agarrar objeto para llave despues de que este escrito
                    Llave nueva_llave = new Llave(offset, Integer.parseInt(key));
                    raf.close();
                    int verify_num_registro = actualizar_numRegistros(1);
                    //Obtener nombre de archivo
                    if (verify_num_registro == 0) {
                        //No existe un arbol, lo crea aqui
                        ArbolB btree_nuevo = new ArbolB(3);
                        btree_nuevo.insert(nueva_llave);
                        escribirArbol(btree_nuevo, nombre_archivo_bin);
                    } else {
                        //Implementacion  availList 

                        //Ya existe un arbol, Cargar arbol de archivo binario
                        ArbolB btree_cargado = cargarArbol(nombre_archivo_bin);
                        
                        if(btree_cargado == null){
                            System.out.println("XD");
                        }
                        
                        btree_cargado.insert(nueva_llave);
                        escribirArbol(btree_cargado, nombre_archivo_bin);
                    }
                } catch (FileNotFoundException ex) {

                } catch (IOException ex) {
                }
                //Incrementar el dato de metadata (Numero de Registros)
                actualizar_numRegistros(3);
                JOptionPane.showMessageDialog(jP_menuArchivo, "Se agrego el registro exitosamente!\n"
                        + "Se actualizo el archivo con el nuevo registro.");
                B_Crear_Campo.setEnabled(false);
                B_Mod_Campo.setEnabled(false);
                B_Borrar_Campo.setEnabled(false);
            }
        }//fin if  
    }//GEN-LAST:event_B_Intro_RegisMouseClicked

    private void b_introducirRegistroMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_b_introducirRegistroMouseClicked

        jd_introducirRegistro.setVisible(false);
        tf_introducirRegistro.setText("");
    }//GEN-LAST:event_b_introducirRegistroMouseClicked

    private void B_Buscar_RegisMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Buscar_RegisMouseClicked

        //Revisar si existen registros
        int num_registros = actualizar_numRegistros(1);
        boolean validar_buscarRegistro = true;

        //Validar Existencia de Campos
        if (archivo_actual.getLista_campos().isEmpty()) {
            JOptionPane.showMessageDialog(jP_menuArchivo, "No existe ningun campo. No pueden existir registros sin que existan campos.");
            validar_buscarRegistro = false;
        }
        //Validar existencia de registros
        if (num_registros == 0) {
            JOptionPane.showMessageDialog(jP_menuArchivo, "El numero de registros en este archivo es de 0.\nIngrese registros para realizar la busqueda.");
            validar_buscarRegistro = false;
        }

        if (validar_buscarRegistro) {

            Campo campo_primario = null;
            //Buscar el campo primario
            for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
                if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria()) {
                    campo_primario = archivo_actual.getLista_campos().get(i);
                    break;
                }
            }

            String registro_buscar = "";
            int valor_llave = 0;
            boolean validar_entrada = false;
            int contador_true = 0;

            while (!validar_entrada) {
                registro_buscar = JOptionPane.showInputDialog(jP_menuArchivo, "Ingrese el dato a buscar mediante el campo: " + campo_primario.getNombre_Campo()
                        + "\nLongitud Campo: " + campo_primario.getLongitud());
                //0. Validacion entrada null
                if (registro_buscar == null) {
                    break;
                }
                contador_true = 0;
                //1.Validacin que la entrada sea un numero
                try {
                    valor_llave = Integer.parseInt(registro_buscar);

                } catch (NumberFormatException e) {
                    JOptionPane.showMessageDialog(jP_menuArchivo, "El dato ingresado debe ser solo de numeros.");
                    validar_entrada = false;
                    contador_true++;
                }
                //2.Validacin que cumpla con la longitud
                if (registro_buscar.length() != campo_primario.getLongitud()) {
                    JOptionPane.showMessageDialog(jP_menuArchivo, "La longitud del registro a buscar no es la requerida.");
                    validar_entrada = false;
                    contador_true++;
                }

                //Paso todas las validaciones
                if (contador_true == 0) {
                    validar_entrada = true;
                    valor_llave = Integer.parseInt(registro_buscar);
                }
            }

            if (validar_entrada) {
                //Obtener nombre de archivo
                int instancia_punto = archivo_actual.getNombre_archivo().indexOf('.');
                String nombre_archivo_bin = "./" + archivo_actual.getNombre_archivo().substring(0, instancia_punto) + ".bin";
                
                //Cargar archivo
                ArbolB btree_cargado = cargarArbol(nombre_archivo_bin);

                Llave llave_buscada = btree_cargado.buscarLlave(btree_cargado.getRaiz(), valor_llave);
                if (llave_buscada == null) {
                    //no encontro la llave
                    JOptionPane.showMessageDialog(jP_menuArchivo, "No se encontro el registro buscado.");
                } else {

                    try {
                        RandomAccessFile raf_buscar = new RandomAccessFile(archivo_actual.getArchivo(), "rw");

                        raf_buscar.seek(llave_buscada.getOffset());
                        String registro_mostrar = raf_buscar.readLine();

                        registro_mostrar = registro_mostrar.replaceAll("\\s+", "");
                        JOptionPane.showMessageDialog(jP_menuArchivo, "Se encontro el registro exitosamente.\n"
                                + registro_mostrar);

                        raf_buscar.close();
                    } catch (FileNotFoundException ex) {

                    } catch (IOException ex) {

                    }

                }
            }
        }
    }//GEN-LAST:event_B_Buscar_RegisMouseClicked

    private void B_Modi_RegisMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Modi_RegisMouseClicked
        // TODO add your handling code here:
        if (jt_Registro.getSelectedRow() != -1) {
            jd_modificarRegistro.setVisible(true);
        } else {
            JOptionPane.showMessageDialog(this, "No selecciono un campo en la tabla");
        }
    }//GEN-LAST:event_B_Modi_RegisMouseClicked

    private void jButton1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton1MouseClicked
        // TODO add your handling code here:
        jd_modificarRegistro.setVisible(false);
        tf_modificarRegistro.setText("");
    }//GEN-LAST:event_jButton1MouseClicked

    private void B_Borrar_RegisMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Borrar_RegisMouseClicked

        int verificar_num_registro = actualizar_numRegistros(1);
        if (verificar_num_registro == 0) {
            JOptionPane.showMessageDialog(jP_menuArchivo, "No existe ningun registro.");
        } else {

            Campo campo_primario = null;
            //Buscar el campo primario
            for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
                if (archivo_actual.getLista_campos().get(i).isEsLlavePrimaria()) {
                    campo_primario = archivo_actual.getLista_campos().get(i);
                    break;
                }
            }
            String primeKey = "";
            int llave = 0;
            boolean flag = false;
            int contador = 0;

            while (!flag) {
                primeKey = JOptionPane.showInputDialog(this, "Ingrese la llave primaria del registro a eliminar: ");
                contador = 0;

                if (primeKey == null) {
                    //do nothing
                    flag = true;
                    contador = 1;
                } else {
                    if (primeKey.isEmpty()) {
                        JOptionPane.showMessageDialog(this, "No ha ingresado ningun valor!");
                        contador++;
                    }
                    try {
                        llave = Integer.parseInt(primeKey);
                    } catch (NumberFormatException e) {
                        JOptionPane.showMessageDialog(this, "La llave ingresada dee ser un valor numerico!");
                        contador++;
                    }

                    if (campo_primario.getLongitud() != primeKey.length()) {
                        JOptionPane.showMessageDialog(this, "La longitud de la llave primaria ingresada no es correcta!");
                        contador++;
                    }

                    if (contador == 0) {
                        flag = true;
                        llave = Integer.parseInt(primeKey);
                    }
                }
            }

            if (flag == true && contador == 0) {

                int instancia_punto = archivo_actual.getNombre_archivo().indexOf('.');
                String nombre_archivo_bin = "./ " + archivo_actual.getNombre_archivo().substring(0, instancia_punto) + ".bin";
                //Cargar archivo
                ArbolB btree_cargado_elim = cargarArbol(nombre_archivo_bin);
                Llave key = btree_cargado_elim.buscarLlave(btree_cargado_elim.raiz, llave);

                if (key == null) {
                    JOptionPane.showMessageDialog(this, "No se encontro la llave en el arbol.");
                } else {
                    Nodo nodo = btree_cargado_elim.searchDeleteNode(btree_cargado_elim.getRaiz(), key.getLlave());
                    boolean isRemoved = btree_cargado_elim.eliminar(nodo, key);

                    if (isRemoved == true) {
                        try {
                            RandomAccessFile raf = new RandomAccessFile(archivo_actual.getArchivo(), "rw");
                            raf.seek(key.getOffset() + 1);
                            raf.writeChar('*');
                            //String registro = raf.readLine();
                            //System.out.println(raf.getFilePointer());
                            //String registro_eliminado = "*" + registro.substring(1) + "\n";

                            //Mover el seek al inicio de la linea
                            //raf.writeChars(registro_eliminado);
                            raf.close();
                        } catch (FileNotFoundException ex) {

                        } catch (IOException ex) {

                        }
                    }
                    //implementacion availist, agregar un nuevo objeto llave
                    int update_num_Records = actualizar_numRegistros(2);
                    //escribirArbol(btree_cargado_elim, nombre_archivo_bin);
                    JOptionPane.showMessageDialog(this, "Se elimino la llave del archivo de registros!");
                }
            }
        }
    }//GEN-LAST:event_B_Borrar_RegisMouseClicked

    private void B_Listar_RegisMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Listar_RegisMouseClicked
        // TODO add your handling code here:
        jp_Registro.setVisible(true);
    }//GEN-LAST:event_B_Listar_RegisMouseClicked

    private void cb_tipoCampoItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cb_tipoCampoItemStateChanged
        //Validacion para desabilitar longitud si escoje un char
        if (cb_tipoCampo.getSelectedIndex() == 5) {
            js_longitud.setValue(1);
            js_longitud.setEnabled(false);
        } else {
            js_longitud.setValue(0);
            js_longitud.setEnabled(true);
        }
    }//GEN-LAST:event_cb_tipoCampoItemStateChanged

    private void jb_RegistrosPruebasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jb_RegistrosPruebasMouseClicked

        File archivo = null;
        File archivo2 = null;

        for (int i = 0; i < 2; i++) {

            if (i == 0) {
                archivo = new File("./Prueba1.txt");
                generarRandRegistros(archivo, "./Prueba1.bin");
            } else {
                archivo2 = new File("./Prueba2.txt");
                generarRandRegistros(archivo2, "./Prueba2.bin");
            }
        }

        JOptionPane.showMessageDialog(this, "Los archivos han sido creados exitosamente!");
    }//GEN-LAST:event_jb_RegistrosPruebasMouseClicked

    private void B_Expo_XMLMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Expo_XMLMouseClicked

        
        try {
            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = factory.newDocumentBuilder();
            DOMImplementation implementation = builder.getDOMImplementation();

            Document documento = implementation.createDocument(null, "Export", null);
            documento.setXmlVersion("1.0");

            Element Campos = documento.createElement("Campos");

            for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {

                String NC = archivo_actual.getLista_campos().get(i).getNombre_Campo();
                String TD = archivo_actual.getLista_campos().get(i).getTipo_dato();
                String LG = Integer.toString(archivo_actual.getLista_campos().get(i).getLongitud());
                String LP = Boolean.toString(archivo_actual.getLista_campos().get(i).isEsLlavePrimaria());
                //System.out.println("Entra");
                //Object[] obj = {c.getNombre_Campo(), c.getTipo_dato(), Integer.toString(c.getLongitud()), c.isEsLlavePrimaria()};

                Element NombreCampo = documento.createElement("NombreDelCampo");
                Text txtNombre = documento.createTextNode(NC);
                NombreCampo.appendChild(txtNombre);
                Campos.appendChild(NombreCampo);

                Element TipoDato = documento.createElement("TipoDeDato");
                Text txtTDato = documento.createTextNode(TD);
                TipoDato.appendChild(txtTDato);
                NombreCampo.appendChild(TipoDato);

                Element Longitud = documento.createElement("Longitud");
                Text txtLong = documento.createTextNode(LG);
                Longitud.appendChild(txtLong);
                NombreCampo.appendChild(Longitud);

                Element isKey = documento.createElement("EsLlavePrimaria");
                Text txtisKey = documento.createTextNode(LP);
                isKey.appendChild(txtisKey);
                NombreCampo.appendChild(isKey);

                documento.getDocumentElement().appendChild(Campos);

            }
            
            Source source = new DOMSource(documento);
            Result result = new StreamResult(new File("Export.xml"));

            Transformer transformer = TransformerFactory.newInstance().newTransformer();
            transformer.transform(source, result);

        } catch (ParserConfigurationException | TransformerException ex) {
            System.out.println(ex.getMessage());
        }

        JOptionPane.showMessageDialog(this, "Exportado con exito");
    }//GEN-LAST:event_B_Expo_XMLMouseClicked

    private void B_Expor_ExcelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_B_Expor_ExcelMouseClicked

        try {
            Workbook wb = new XSSFWorkbook();
            Sheet sheet = wb.createSheet("Prueba1");
            Row rowCol = sheet.createRow(0);
            for (int i = 0; i < jt_Registro.getColumnCount(); i++) {
                Cell cell = rowCol.createCell(i);
                cell.setCellValue(jt_Registro.getColumnName(i));
            }
            for (int j = 0; j < jt_Registro.getRowCount(); j++) {
                Row row = sheet.createRow(j + 1);
                for (int k = 0; k < jt_Registro.getColumnCount(); k++) {
                    Cell cell = row.createCell(k);
                    if (jt_Registro.getValueAt(j, k) != null) {
                        cell.setCellValue(jt_Registro.getValueAt(j, k).toString());
                    }
                }
            }
            FileOutputStream out = new FileOutputStream(new File("PruebaJ.xlsx"));
            wb.write(out);
            wb.close();
            out.close();

            JOptionPane.showMessageDialog(this, "Exportado con exito");

        } catch (FileNotFoundException e) {
            System.out.println(e);
        } catch (IOException io) {
            System.out.println(io);
        }
    }//GEN-LAST:event_B_Expor_ExcelMouseClicked

    public void generarRandRegistros(File archivo, String nombre) {
        ArbolB prueba1 = new ArbolB(3);

        //crear campos
        ArrayList<Campo> campos = new ArrayList();

        Campo c1 = new Campo("Nombre", "String", 10);
        Campo c2 = new Campo("Apellido", "String", 12);
        Campo c3 = new Campo("NumId", "int", 8);
        Campo c4 = new Campo("Telefono", "int", 9);
        Campo c5 = new Campo("Ciudad", "String", 15);

        c1.setEsLlavePrimaria(false);
        c2.setEsLlavePrimaria(false);
        c3.setEsLlavePrimaria(true);
        c4.setEsLlavePrimaria(false);
        c5.setEsLlavePrimaria(false);

        campos.add(c3);
        campos.add(c1);
        campos.add(c2);
        campos.add(c4);
        campos.add(c5);

        escribirPruebaCampos(archivo, campos);

        RandomAccessFile raf;

        //Arraylists y arrays para crear los archivos
        String[] nombres = {"Sophia", "Liam", "Olivia", "Noah", "Riley", "Jackson",
            "Emma", "Aiden", "Ava", "Elias", "Isabella", "Gonzalo", "Ariela", "Lucas",
            "Beatriz", "Oliver", "Amalia", "Juan", "Mia", "Mateo", "Layla", "Marco",
            "Zoe", "Mason", "Camila", "Carlos", "Charlotte", "Karl", "Iliana", "Ethan",
            "Mila", "Sebastian", "Lily", "James", "Luna", "Michael", "Ana", "Benjamin",
            "Evelyn", "Logan", "Harper", "Leo", "Liliana", "Luca", "Ela", "Alexander",
            "Chloe", "Daniel", "Adalyn", "Josiah", "Charlie", "Henry", "Isla", "Jayce",
            "Ellie", "Julian", "Leah", "Jack", "Nora", "Ryan", "Scarlett", "Jacob",
            "Maya", "Asher", "Abigail", "Wyatt", "Madison", "William", "Aubrey", "Owen",
            "Emily", "Gabriel", "Kinsley", "Miles", "Elena", "Lincoln", "Paisely", "Ezra",
            "Madelyn", "Isaias", "Aurora", "Luke", "Peyton", "Cameron", "Nova", "Caleb",
            "Emilia", "Isaac", "Hannah", "Carson", "Sarah", "Samuel", "Ariana", "Colton",
            "Penny", "Maverick", "Lila", "Mathew", "Valeria", "Miguel"};

        ArrayList<String> names = new ArrayList();

        names.addAll(Arrays.asList(nombres));

        String[] apellidos = {"Smith", "Hall", "Stewart", "Price", "Johnson",
            "Allen", "Sanchez", "Bennett", "William", "Young", "Morris", "Wood",
            "Jones", "Hernandez", "Rogers", "Barnes", "Brown", "King", "Reed", "Ross",
            "Davis", "Wright", "Cook", "Henderson", "Miller", "Lopez", "Morgan", "Coleman",
            "Wilson", "Hill", "Bell", "Jenkins", "Moore", "Scott", "Murphy", "Perry",
            "Taylor", "Green", "Bailey", "Powell", "Anderson", "Rivera", "Adams", "Long",
            "Thomas", "Baker", "Cooper", "Patterson", "Jackson", "Gonzales", "Richardson",
            "Hughes", "White", "Nelson", "Cox", "Flores", "Harris", "Carter", "Howard",
            "Washington", "Martin", "Mitchell", "Ward", "Butler", "Thompson", "Perez",
            "Torres", "Simmons", "Garcia", "Roberts", "Peterson", "Foster", "Martinez",
            "Gray", "Turner", "Rojas", "Robinson", "Philips", "Ramirez", "Bryant",
            "Clark", "Campbell", "James", "Alexander", "Rodriguez", "Parker", "Watson",
            "Russell", "Lewis", "Evans", "Brooks", "Griffin", "Lee", "Edwards", "Kelly",
            "Diaz", "Walker", "Collins", "Sanders", "Hayes"};

        //lista de apellidos
        ArrayList<String> surenames = new ArrayList();
        surenames.addAll(Arrays.asList(apellidos));

        //generador de identificaciones
        ArrayList<String> id = new ArrayList();
        id.add("8");
        id.add("1");
        id.add("2");
        id.add("3");
        id.add("4");
        id.add("5");
        id.add("6");
        id.add("7");

        //generador de numeros de telefono
        ArrayList<String> tel = new ArrayList();
        tel.add("1");
        tel.add("2");
        tel.add("3");
        tel.add("4");
        tel.add("5");
        tel.add("6");
        tel.add("7");
        tel.add("8");
        tel.add("9");

        //ciudades donde viven
        String[] ciudades = {"NY", "Chicago", "LA", "Houston",
            "Phoenix", "Philadelphia", "San Antonio", "SD", "Austin", "Forthworth",
            "Jacksonville", "Columbus", "Charlotte", "Indianapolis", "SF",
            "Seattle", "Denver", "Washington", "Boston", "El Paso", "Nashville",
            "Detroit", "Oxnard", "Oklahoma", "Portland", "Memphis", "Louisville",
            "Milwaukee", "Baltimore", "Albuquerque", "Tucson", "Fresno", "Mesa", "Sacramento",
            "Atlanta", "Kansas", "Colorado", "Omaha", "Raleigh", "Miami",
            "Longhorn", "Minneapolis", "Oakland", "Tampa", "Tulsa", "Arlington", "Wichita",
            "Lafayette", "Bakersfield", "Cleveland", "Anaheim", "Honolulu",
            "Dallas", "Riverside", "Henderson", "Lexington", "Stockton", "Miami",
            "Cincinnati", "Pittsburg"};

        ArrayList<String> cities = new ArrayList();
        cities.addAll(Arrays.asList(ciudades));

        String name, surename, city;

        int randNum = 0;
        int randCity = 0;
        int numTel = 0;
        int numId = 0;

        Random r = new Random();
        Llave llave;

        try {
            raf = new RandomAccessFile(archivo, "rw");
            raf.seek(raf.length());

            long pointer;

            for (int i = 0; i < 5000; i++) {
                randNum = 0 + r.nextInt(99);
                randCity = 0 + r.nextInt(60);

                Collections.shuffle(id);
                Collections.shuffle(tel);
                Collections.shuffle(names);
                Collections.shuffle(surenames);

                String var = "";
                //ciclo que brinda el numero de telefono 
                for (int j = 0; j < tel.size(); j++) {
                    var += tel.get(j);
                }
                numTel = Integer.parseInt(var);
                var = "";

                for (int k = 0; k < id.size(); k++) {
                    var += id.get(k);
                }
                numId = Integer.parseInt(var);

                name = names.get(randNum);
                surename = surenames.get(randNum);
                city = cities.get(randCity);

                pointer = raf.getFilePointer();
                llave = new Llave(pointer, numId);
                
               // System.out.println(llave);

                raf.writeChars(numId + "|" + fixLength(name, c1.getLongitud()) + "|"
                        + fixLength(surename, c2.getLongitud()) + "|"
                        + numTel + "|" + fixLength(city, c5.getLongitud()) + "| \n");
                
                //actualizar_numRegistros(3);

                prueba1.insert(llave);
            }
            
       

            raf.close();

            escribirArbol(prueba1, nombre);
           
        } catch (IOException e) {

        }
    }

    public void escribirPruebaCampos(File archivo, ArrayList<Campo> campos) {

        FileWriter fo = null;
        BufferedWriter bw = null;

        try {

            String nombre, tipo, longitud, esllave;

            fo = new FileWriter(archivo);
            bw = new BufferedWriter(fo);

            //imprime el numero de campos
            bw.write("5 \n");

            for (int i = 0; i < 5; i++) {

                Campo temp = campos.get(i);
                nombre = temp.getNombre_Campo();
                tipo = temp.getTipo_dato();
                longitud = Integer.toString(temp.getLongitud());
                if (temp.isEsLlavePrimaria()) {
                    esllave = "true";
                } else {
                    esllave = "false";
                }

                bw.write("{Nombre:" + nombre + ",Tipo:" + tipo
                        + ",Longitud:" + longitud + ",EsLlave:" + esllave + "}");
                bw.write("\n");
            }

            Date d = new Date();
            bw.write(d.toString() + "\n");

            bw.write("Numero de Registros:" + "5000");
            bw.write("\n \n");

            bw.flush();

        } catch (Exception e) {

        }

        try {
            bw.close();
            fo.close();
        } catch (IOException e) {

        }
    }

    public String fixLength(String registro, int longitud) {

        int length = longitud - registro.length();

        for (int i = 0; i < length; i++) {
            registro += " ";
        }

        return registro;
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new GUI().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton B_Abrir_Arch;
    private javax.swing.JButton B_Borrar_Campo;
    private javax.swing.JButton B_Borrar_Regis;
    private javax.swing.JButton B_Buscar_Regis;
    private javax.swing.JButton B_Cerrar_Arch;
    private javax.swing.JButton B_Crear_Arch;
    private javax.swing.JButton B_Crear_Campo;
    private javax.swing.JButton B_Expo_XML;
    private javax.swing.JButton B_Expor_Excel;
    private javax.swing.JButton B_Intro_Regis;
    private javax.swing.JButton B_Listar_Campo;
    private javax.swing.JButton B_Listar_Regis;
    private javax.swing.JButton B_Mod_Campo;
    private javax.swing.JButton B_Modi_Regis;
    private javax.swing.JButton B_Nuevo_Arch;
    private javax.swing.JButton B_ReIndex_Arch;
    private javax.swing.JButton B_Salir;
    private javax.swing.JButton B_Salvar_Arch;
    private javax.swing.ButtonGroup BgLlavePrimaria;
    private javax.swing.JFrame TablaRegis_NoSeMuestra;
    private javax.swing.JButton b_introducirRegistro;
    private javax.swing.JComboBox<String> cb_tipoCampo;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jP_crearCampo;
    private javax.swing.JPanel jP_introducirRegistro;
    private javax.swing.JPanel jP_menuArchivo;
    private javax.swing.JPanel jP_tabla_ListarCampos;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JTabbedPane jTP_Menus;
    private javax.swing.JTree jT_Archivos;
    private javax.swing.JButton jb_RegistrosPruebas;
    private javax.swing.JButton jb_abrirArchivo;
    private javax.swing.JButton jb_crearCampo;
    private javax.swing.JButton jb_modCampo;
    private javax.swing.JButton jb_salirAbrirArchivo;
    private javax.swing.JDialog jd_abrirArchivo;
    private javax.swing.JDialog jd_buscarRegistro;
    private javax.swing.JDialog jd_crearCampo;
    private javax.swing.JDialog jd_introducirRegistro;
    private javax.swing.JDialog jd_modificarRegistro;
    private javax.swing.JLabel jl_CrearCampo;
    private javax.swing.JLabel jl_Longitud;
    private javax.swing.JLabel jl_NombredeCampo;
    private javax.swing.JLabel jl_Registro;
    private javax.swing.JLabel jl_TipodeDato;
    private javax.swing.JLabel jl_nombre_archivo;
    private javax.swing.JLabel jl_tituloCampos;
    private javax.swing.JPanel jp_Campos;
    private javax.swing.JPanel jp_Registro;
    private javax.swing.JRadioButton jr_llaveNo;
    private javax.swing.JRadioButton jr_llaveSi;
    private javax.swing.JSpinner js_longitud;
    private javax.swing.JTable jt_Regis_NM;
    private javax.swing.JTable jt_Registro;
    private javax.swing.JTextField jt_nombreCampo;
    private javax.swing.JTable table_ListarCampos;
    private javax.swing.JTextField tf_introducirRegistro;
    private javax.swing.JTextField tf_modificarRegistro;
    // End of variables declaration//GEN-END:variables

    //Variables locales
    DefaultMutableTreeNode nodo_seleccionado = null;
    int campo_seleccionado = 0;

    public void refrescarJTree() {
        DefaultTreeModel m = (DefaultTreeModel) jT_Archivos.getModel();
        DefaultMutableTreeNode raiz = (DefaultMutableTreeNode) m.getRoot();
        DefaultMutableTreeNode nodo_archivo;

        //Dejar limpio el arbol al actualizar
        raiz.removeAllChildren();
        m.reload();

        for (int i = 0; i < Lista_Archivos.size(); i++) {
            nodo_archivo = new DefaultMutableTreeNode(Lista_Archivos.get(i));
            raiz.add(nodo_archivo);
        }
        m.reload();
    }

    public void refrescarTabla() {

        table_ListarCampos.setModel(new javax.swing.table.DefaultTableModel(
                new Object[][]{},
                new String[]{
                    "Nombre", "Tipo de Dato", "Longitud", "Es llave Primaria"
                }
        ));

        DefaultTableModel model = (DefaultTableModel) table_ListarCampos.getModel();

        for (Campo c : archivo_actual.getLista_campos()) {
            Object[] obj = {c.getNombre_Campo(), c.getTipo_dato(), Integer.toString(c.getLongitud()), c.isEsLlavePrimaria()};
            model.addRow(obj);
        }
        table_ListarCampos.setModel(model);
    }

    public int actualizar_numRegistros(int opcion) {
        int temp = -1;
        try {
            RandomAccessFile raf = new RandomAccessFile(archivo_actual.getArchivo(), "rw");
            int num_lineas = archivo_actual.getLista_campos().size() + 2;
            String linea_overwrite = "";
            while (raf.readLine() != null) {
                long posicion_line = raf.getFilePointer();
                linea_overwrite = raf.readLine();

                if (linea_overwrite.contains("Numero de Registros:")) {

                    int posicion_num = linea_overwrite.indexOf(':');
                    int num_registro;

                    //Substring para obtener el numero de registros
                    String str_numero = linea_overwrite.substring(posicion_num + 1);
                    //Cuando el numero de registros esta entre [0 ,9]
                    if (str_numero.length() == 1) {
                        num_registro = Integer.parseInt(String.valueOf(str_numero.charAt(0)));
                    } else {
                        //numero de registros es mayor a 9|  x > 9
                        num_registro = Integer.parseInt(linea_overwrite.substring(posicion_num + 1));
                    }

                    //Esta buscando el numero de registros
                    switch (opcion) {
                        case 1:
                            //Obtener numero de registro
                            temp = num_registro;
                            break;
                        case 2:
                            //Actualizar numero de registros (Decrementar)
                            num_registro--;
                            raf.seek(posicion_line);
                            raf.writeUTF("Numero de Registros:" + num_registro + "\n");
                            raf.close();
                            break;
                        default:
                            //Esta actualizando el numero de registros (Incrementando)
                            num_registro++;
                            raf.seek(posicion_line);
                            raf.writeUTF("Numero de Registros:" + num_registro + "\n");
                            raf.close();
                            break;
                    }
                    break;
                }

            }

        } catch (FileNotFoundException ex) {
        } catch (IOException ex) {
        }

        return temp;

    }

    public void escribirArbol(ArbolB btree, String nombre_archivo_bin) {

        //Crear arbol si es la primera vez metiendo registros
        File archivo_bin_arbol = new File(nombre_archivo_bin);
        FileOutputStream fw = null;
        ObjectOutputStream bw = null;
        try {
            fw = new FileOutputStream(archivo_bin_arbol);
            bw = new ObjectOutputStream(fw);
            bw.writeObject(btree);
            bw.flush();
        } catch (Exception ex) {
        } finally {
            try {
                bw.close();
                fw.close();
            } catch (Exception ex) {
            }
        }
    }

    public ArbolB cargarArbol(String nombre_archivo_bin) {

        ArbolB btree_temp = null;

        File cargar_bin = new File(nombre_archivo_bin);

        try {
            if (cargar_bin.exists()) {
                FileInputStream entrada = new FileInputStream(cargar_bin);
                ObjectInputStream objeto = new ObjectInputStream(entrada);
                btree_temp = (ArbolB) objeto.readObject();
                objeto.close();
                entrada.close();
            }
        } catch (Exception e) {
        }
        return btree_temp;

    }

    public void escribirArchivo() {
        archivo_actual.setGuardado(true);
        FileWriter fw = null;
        BufferedWriter bw = null;
        //Aplicar el nuevo nombre dado  

        try {
            fw = new FileWriter(archivo_actual.getArchivo(), false);
            bw = new BufferedWriter(fw);

            //Escribir la definicion de los campos y registros
            //Escritura de los campos en metadata
            String nombre, tipo, longitud, esllave;
            if (archivo_actual.getLista_campos().isEmpty()) {
                //do nothing 
            } else {

                //imprimir el numero de campos del archivo para su correcta lectura
                bw.write(archivo_actual.getLista_campos().size() + "\n");

                for (int i = 0; i < archivo_actual.getLista_campos().size(); i++) {
                    Campo temp = archivo_actual.getLista_campos().get(i);
                    nombre = temp.getNombre_Campo();
                    tipo = temp.getTipo_dato();
                    longitud = Integer.toString(temp.getLongitud());
                    if (temp.isEsLlavePrimaria()) {
                        esllave = "true";
                    } else {
                        esllave = "false";
                    }

                    bw.write("{Nombre:" + nombre + ",Tipo:" + tipo
                            + ",Longitud:" + longitud + ",EsLlave:" + esllave + "}");
                    bw.write("\n");
                }

                //escritura de la ultima fecha de modificacion/apertura
                Date d = new Date();
                bw.write(d.toString() + "\n");
                bw.write(("Numero de Registros:0\n"));
                //TODO escritura de la cantidad de registros

                //TODO escribir la punta de reconstruccion availlist
            }
            bw.flush();
        } catch (Exception ex) {

        } finally {
            try {
                bw.close();
                fw.close();
            } catch (IOException e) {
            }
        }
    }//Fin metodo escribir archivo
}
